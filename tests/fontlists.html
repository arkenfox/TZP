<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=700">
	<title>font lists</title>
	<link rel="stylesheet" type="text/css" href="testindex.css">
	<script src="testglobals.js"></script>
	<script src="testgeneric.js"></script>
	<style>
		table {width: 680px;}
		hr {color: #8ca7dc}
	</style>
</head>

<body>

	<div class="hidden"><input type="reset" value="" id="widget0"></div>

	<table>
	<tr><td><h2>TorZillaPrint</h2></td></tr>
	<tr><td class="blurb"><a class="return" href="../index.html">return to TZP index</a></td></tr>
	</table>

	<table id="tb12">
		<col width="20%"><col width="80%">
		<thead><tr><th colspan="2">
			<div class="nav-title">font lists</div>
		</th></tr></thead>
		<tr><td colspan="2" class="intro"><!-- &#9745; &#9744; -->
			<span class="no_color">Checking full OS font lists against smaller ones.
				<ul><li>The MIN test, <b><u>with</u></b> font protection, shouldn't detect anything outside of min.</li>
				<li>The FULL test, <b><u>without</u></b> font protection, shouldn't detect faces.</li>
				<li>Run both tests to check if any min fonts are blocked with font protection</li></ul>
			</span>
		</td></tr>
		<tr><td colspan="2" class="mono" style="text-align: left; vertical-align: top;">
			<span id="bmin" class="btn12 btnfirst" onClick="run('min')">[ min + RFP/TB ]</span>
			<span id="bfull" class="btn12 btn" onClick="run('full')">[ full ]</span>
			<!--<span class="btn12 btn" onClick="check_fntLists()">[ check lists integrity ]</span>-->
			<br><br><hr>
			<span class="mono spaces" style="color: #b3b3b3;" id="statstitle"></span>
			<input type="checkbox" id="logtype">
			<span style="color: #b3b3b3;">click counts to log: &#9745; single line &#9744; multi-line</span>
			<span class="mono spaces" style="color: #b3b3b3;" id="stats"></span>
			<br><br><hr>
			<br><span class="spaces" style="color: #b3b3b3;" id="results"></span>
			</td>
		</tr>
	</table>
	<br>

<script>
'use strict';

let fntStrA = "mmmLLLmmmWWWwwwmmmllliii",
	fntList = [],
	fntListCheck = [],
	oBaseFonts = {},
	fntFake = "",
	strOS = "",
	fntBaseStats = "",
	fntBaseDimensions = "",
	fntPoison = "",
	baseFonts = ['monospace','sans-serif','serif'],
	baseGeneric = baseFonts,
	bTB = false

// remember results across the two tests
let notFoundInMin = [],
	foundInAll = []

sb = sb.trim()
sg = sg.trim()
s4 = s4.trim()
s12 = s12.trim()
s14 = s14.trim()
dom.logtype.checked = true


let fntMaster = {android: [], linux: [],mac: [], windows: []}
let fntMasterBase = {android: [], linux: [],mac: [], windows: []}
let fntDupes = {android: [], linux: [],mac: [], windows: []}

let fntOther = {
	android: ['Droid Sans','Droid Sans Mono','Droid Serif','Noto Color Emoji','Noto Emoji','Noto Kufi Arabic','Noto Mono','Noto Naskh Arabic','Noto Nastaliq Urdu','Noto Sans','Noto Sans Adlam','Noto Sans Adlam Unjoined','Noto Sans Anatolian Hieroglyphs','Noto Sans Arabic','Noto Sans Armenian','Noto Sans Avestan','Noto Sans Balinese','Noto Sans Bamum','Noto Sans Batak','Noto Sans Bengali','Noto Sans Brahmi','Noto Sans Buginese','Noto Sans Buhid','Noto Sans CJK JP','Noto Sans CJK KR','Noto Sans CJK SC','Noto Sans CJK SC Regular','Noto Sans CJK TC','Noto Sans Canadian Aboriginal','Noto Sans Carian','Noto Sans Chakma','Noto Sans Cham','Noto Sans Cherokee','Noto Sans Coptic','Noto Sans Cuneiform','Noto Sans Cypriot','Noto Sans Deseret','Noto Sans Devanagari','Noto Sans Display','Noto Sans Egyptian Hieroglyphs','Noto Sans Ethiopic','Noto Sans Georgian','Noto Sans Glagolitic','Noto Sans Gothic','Noto Sans Gujarati','Noto Sans Gurmukhi','Noto Sans Hanunoo','Noto Sans Hebrew','Noto Sans Imperial Aramaic','Noto Sans Inscriptional Pahlavi','Noto Sans Inscriptional Parthian','Noto Sans JP Regular','Noto Sans Javanese','Noto Sans KR Regular','Noto Sans Kaithi','Noto Sans Kannada','Noto Sans Kayah Li','Noto Sans Kharoshthi','Noto Sans Khmer','Noto Sans Lao','Noto Sans Lepcha','Noto Sans Limbu','Noto Sans Linear B','Noto Sans Lisu','Noto Sans Lycian','Noto Sans Lydian','Noto Sans Malayalam','Noto Sans Mandaic','Noto Sans Meetei Mayek','Noto Sans Mongolian','Noto Sans Mono','Noto Sans Myanmar','Noto Sans NKo','Noto Sans New Tai Lue','Noto Sans Ogham','Noto Sans Ol Chiki','Noto Sans Old Italic','Noto Sans Old Persian','Noto Sans Old South Arabian','Noto Sans Old Turkic','Noto Sans Oriya','Noto Sans Osage','Noto Sans Osmanya','Noto Sans Phags Pa','Noto Sans Phoenician','Noto Sans Rejang','Noto Sans Runic','Noto Sans SC Regular','Noto Sans Samaritan','Noto Sans Saurashtra','Noto Sans Shavian','Noto Sans Sinhala','Noto Sans Sundanese','Noto Sans Syloti Nagri','Noto Sans Symbols','Noto Sans Symbols2','Noto Sans Syriac Eastern','Noto Sans Syriac Estrangela','Noto Sans Syriac Western','Noto Sans TC Regular','Noto Sans Tagalog','Noto Sans Tagbanwa','Noto Sans Tai Le','Noto Sans Tai Tham','Noto Sans Tai Viet','Noto Sans Tamil','Noto Sans Telugu','Noto Sans Thaana','Noto Sans Thai','Noto Sans Tibetan','Noto Sans Tifinagh','Noto Sans Ugaritic','Noto Sans Vai','Noto Sans Yi','Noto Serif','Noto Serif Armenian','Noto Serif Balinese','Noto Serif Bengali','Noto Serif CJK JP','Noto Serif CJK KR','Noto Serif CJK SC','Noto Serif CJK TC','Noto Serif Devanagari','Noto Serif Display','Noto Serif Ethiopic','Noto Serif Georgian','Noto Serif Gujarati','Noto Serif Gurmukhi','Noto Serif Hebrew','Noto Serif Kannada','Noto Serif Khmer','Noto Serif Lao','Noto Serif Malayalam','Noto Serif Myanmar','Noto Serif Sinhala','Noto Serif Tamil','Noto Serif Telugu','Noto Serif Thai','Noto Serif Tibetan','Roboto','Roboto Condensed',],
	linux: ['AR PL UKai CN','AR PL UKai HK','AR PL UKai TW','AR PL UKai TW MBE','AR PL UMing CN','AR PL UMing HK','AR PL UMing TW','AR PL UMing TW MBE','Abyssinica SIL','Aharoni CLM','AlArabiya','AlBattar','AlHor','AlManzomah','AlYarmook','Amiri','Amiri Quran','Amiri Quran Colored','Ani','AnjaliOldLipi','Arab','Arial','Arimo','Bitstream Charter','C059','Caladea','Caladings CLM','Cantarell','Cantarell Extra Bold','Cantarell Light','Cantarell Thin','Carlito','Century Schoolbook L','Chandas','Chilanka','Comfortaa','Comfortaa Light','Cortoba','Courier','Courier 10 Pitch','Courier New','Cousine','D050000L','David CLM','DejaVu Math TeX Gyre','DejaVu Sans','DejaVu Sans Condensed','DejaVu Sans Light','DejaVu Sans Mono','DejaVu Serif','DejaVu Serif Condensed','Dimnah','Dingbats','Droid Arabic Kufi','Droid Sans','Droid Sans Armenian','Droid Sans Devanagari','Droid Sans Ethiopic','Droid Sans Fallback','Droid Sans Georgian','Droid Sans Hebrew','Droid Sans Japanese','Droid Sans Tamil','Droid Sans Thai','Drugulin CLM','Dyuthi','Electron','Ellinia CLM','Ezra SIL','Ezra SIL SR','Frank Ruehl CLM','FreeMono','FreeSans','FreeSerif','Furat','Gargi','Garuda','Gayathri','Gayathri Thin','Georgia','Granada','Graph','Gubbi','Hadasim CLM','Hani','Haramain','Homa','Hor','Jamrul','Japan','Jet','Jomolhari','KacstArt','KacstBook','KacstDecorative','KacstDigital','KacstFarsi','KacstLetter','KacstNaskh','KacstOffice','KacstOne','KacstPen','KacstPoster','KacstQurn','KacstScreen','KacstTitle','KacstTitleL','Kalapi','Kalimati','Karumbi','Kayrawan','Keraleeyam','Keter YG','Khalid','Khmer OS','Khmer OS Battambang','Khmer OS Bokor','Khmer OS Content','Khmer OS Fasthand','Khmer OS Freehand','Khmer OS Metal Chrieng','Khmer OS Muol','Khmer OS Muol Light','Khmer OS Muol Pali','Khmer OS Siemreap','Khmer OS System','Kinnari','LKLUG','Laksaman','Liberation Mono','Liberation Sans','Liberation Sans Narrow','Liberation Serif','Likhan','Lohit Assamese','Lohit Bengali','Lohit Devanagari','Lohit Gujarati','Lohit Gurmukhi','Lohit Kannada','Lohit Malayalam','Lohit Odia','Lohit Tamil','Lohit Tamil Classical','Lohit Telugu','Loma','Manjari','Manjari Thin','Mashq','Mashq-Bold','Meera','Metal','Mingzat','Miriam CLM','Miriam Mono CLM','Mitra Mono','Montserrat','Montserrat Black','Montserrat ExtraBold','Montserrat ExtraLight','Montserrat Light','Montserrat Medium','Montserrat SemiBold','Montserrat Thin','Mukti Narrow','Mukti Narrow Bold','Nachlieli CLM','Nada','Nagham','Nakula','Navilu','Nazli','Nice','Nimbus Mono L','Nimbus Mono PS','Nimbus Roman','Nimbus Roman No9 L','Nimbus Sans','Nimbus Sans L','Nimbus Sans Narrow','Norasi','Noto Color Emoji','Noto Emoji','Noto Mono','Noto Naskh Arabic','Noto Sans','Noto Sans Armenian','Noto Sans Balinese','Noto Sans Bengali','Noto Sans Buginese','Noto Sans CJK HK','Noto Sans CJK HK Black','Noto Sans CJK HK DemiLight','Noto Sans CJK HK Light','Noto Sans CJK HK Medium','Noto Sans CJK HK Thin','Noto Sans CJK JP','Noto Sans CJK JP Black','Noto Sans CJK JP DemiLight','Noto Sans CJK JP Light','Noto Sans CJK JP Medium','Noto Sans CJK JP Thin','Noto Sans CJK KR','Noto Sans CJK KR Black','Noto Sans CJK KR DemiLight','Noto Sans CJK KR Light','Noto Sans CJK KR Medium','Noto Sans CJK KR Thin','Noto Sans CJK SC','Noto Sans CJK SC Black','Noto Sans CJK SC DemiLight','Noto Sans CJK SC Light','Noto Sans CJK SC Medium','Noto Sans CJK SC Thin','Noto Sans CJK TC','Noto Sans CJK TC Black','Noto Sans CJK TC DemiLight','Noto Sans CJK TC Light','Noto Sans CJK TC Medium','Noto Sans CJK TC Thin','Noto Sans Canadian Aboriginal','Noto Sans Cherokee','Noto Sans Devanagari','Noto Sans Ethiopic','Noto Sans Georgian','Noto Sans Gujarati','Noto Sans Gurmukhi','Noto Sans Hebrew','Noto Sans JP Regular','Noto Sans KR Regular','Noto Sans Kannada','Noto Sans Khmer','Noto Sans Lao','Noto Sans Malayalam','Noto Sans Mongolian','Noto Sans Mono CJK HK','Noto Sans Mono CJK JP','Noto Sans Mono CJK KR','Noto Sans Mono CJK SC','Noto Sans Mono CJK TC','Noto Sans Myanmar','Noto Sans Oriya','Noto Sans SC Regular','Noto Sans Sinhala','Noto Sans TC Regular','Noto Sans Tamil','Noto Sans Telugu','Noto Sans Thaana','Noto Sans Thai','Noto Sans Tibetan','Noto Sans Yi','Noto Serif','Noto Serif Armenian','Noto Serif Balinese','Noto Serif Bengali','Noto Serif CJK JP','Noto Serif CJK JP Black','Noto Serif CJK JP ExtraLight','Noto Serif CJK JP Light','Noto Serif CJK JP Medium','Noto Serif CJK JP SemiBold','Noto Serif CJK KR','Noto Serif CJK KR Black','Noto Serif CJK KR ExtraLight','Noto Serif CJK KR Light','Noto Serif CJK KR Medium','Noto Serif CJK KR SemiBold','Noto Serif CJK SC','Noto Serif CJK SC Black','Noto Serif CJK SC ExtraLight','Noto Serif CJK SC Light','Noto Serif CJK SC Medium','Noto Serif CJK SC SemiBold','Noto Serif CJK TC','Noto Serif CJK TC Black','Noto Serif CJK TC ExtraLight','Noto Serif CJK TC Light','Noto Serif CJK TC Medium','Noto Serif CJK TC SemiBold','Noto Serif Devanagari','Noto Serif Ethiopic','Noto Serif Georgian','Noto Serif Gujarati','Noto Serif Gurmukhi','Noto Serif Hebrew','Noto Serif Kannada','Noto Serif Khmer','Noto Serif Lao','Noto Serif Malayalam','Noto Serif Myanmar','Noto Serif Sinhala','Noto Serif Tamil','Noto Serif Telugu','Noto Serif Thai','Noto Serif Tibetan','Nuosu SIL','OpenSymbol','Ostorah','Ouhod','Ouhod-Bold','P052','PT Sans','PT Sans Narrow','Padauk','Padauk Book','Pagul','PakType Naskh Basic','Petra','Phetsarath OT','Pothana2000','Purisa','Rachana','RaghuMalayalamSans','Rasa','Rasa Light','Rasa Medium','Rasa SemiBold','Rasheeq','Rasheeq-Bold','Rehan','Rekha','STIX','STIX Math','STIX Two Math','STIX Two Text','Saab','Sahadeva','Salem','Samanata','Samyak Devanagari','Samyak Gujarati','Samyak Malayalam','Samyak Tamil','Sarai','Sawasdee','Scheherazade','Shado','Sharjah','Shofar','Simple CLM','Sindbad','Source Code Pro','Source Code Pro Black','Source Code Pro ExtraLight','Source Code Pro Light','Source Code Pro Medium','Source Code Pro Semibold','Stam Ashkenaz CLM','Stam Sefarad CLM','Standard Symbols L','Standard Symbols PS','Suruma','Symbola','Tarablus','Tholoth','Tibetan Machine Uni','Tinos','Titr','Tlwg Mono','Tlwg Typewriter','Tlwg Typist','Tlwg Typo','UKIJ 3D','UKIJ Basma','UKIJ Bom','UKIJ CJK','UKIJ Chechek','UKIJ Chiwer Kesme','UKIJ Diwani','UKIJ Diwani Kawak','UKIJ Diwani Tom','UKIJ Diwani Yantu','UKIJ Ekran','UKIJ Elipbe','UKIJ Elipbe_Chekitlik','UKIJ Esliye','UKIJ Esliye Chiwer','UKIJ Esliye Neqish','UKIJ Esliye Qara','UKIJ Esliye Tom','UKIJ Imaret','UKIJ Inchike','UKIJ Jelliy','UKIJ Junun','UKIJ Kawak','UKIJ Kawak 3D','UKIJ Kesme','UKIJ Kesme Tuz','UKIJ Kufi','UKIJ Kufi 3D','UKIJ Kufi Chiwer','UKIJ Kufi Gul','UKIJ Kufi Kawak','UKIJ Kufi Tar','UKIJ Kufi Uz','UKIJ Kufi Yay','UKIJ Kufi Yolluq','UKIJ Mejnun','UKIJ Mejnuntal','UKIJ Merdane','UKIJ Moy Qelem','UKIJ Nasq','UKIJ Nasq Zilwa','UKIJ Orqun Basma','UKIJ Orqun Yazma','UKIJ Orxun-Yensey','UKIJ Qara','UKIJ Qolyazma','UKIJ Qolyazma Tez','UKIJ Qolyazma Tuz','UKIJ Qolyazma Yantu','UKIJ Ruqi','UKIJ Saet','UKIJ Sulus','UKIJ Sulus Tom','UKIJ Teng','UKIJ Tiken','UKIJ Title','UKIJ Tor','UKIJ Tughra','UKIJ Tuz','UKIJ Tuz Basma','UKIJ Tuz Gezit','UKIJ Tuz Kitab','UKIJ Tuz Neqish','UKIJ Tuz Qara','UKIJ Tuz Tom','UKIJ Tuz Tor','UKIJ Zilwa','UKIJ_Mac Basma','UKIJ_Mac Ekran','URW Bookman','URW Bookman L','URW Chancery L','URW Gothic','URW Gothic L','URW Palladio L','Ubuntu','Ubuntu Condensed','Ubuntu Light','Ubuntu Mono','Ubuntu Thin','Umpush','Uroob','Vemana2000','Verdana','Waree','Yehuda CLM','Yrsa','Yrsa Light','Yrsa Medium','Yrsa SemiBold','Z003','aakar','mry_KacstQurn','ori1Uni','padmaa','padmaa-Bold.1.1','padmmaa','utkal','מרים','गार्गी','नालिमाटी','অনি Dvf','মিত্র','মুক্তি','মুক্তি পাতনা',],
	mac: ["American Typewriter Condensed","American Typewriter Condensed Light","American Typewriter Light","American Typewriter Semibold","Apple Braille Outline 6 Dot","Apple Braille Outline 8 Dot","Apple Braille Pinpoint 6 Dot","Apple Braille Pinpoint 8 Dot","Apple LiGothic Medium","Apple LiSung Light","Apple SD Gothic Neo Heavy","Apple SD Gothic Neo Light","Apple SD Gothic Neo Medium","Apple SD Gothic Neo SemiBold","Apple SD Gothic Neo UltraLight","Apple SD GothicNeo ExtraBold","Athelas","Avenir Book Oblique","Avenir Heavy Oblique","Avenir Light Oblique","Avenir Medium Oblique","Avenir Next Condensed Bold","Avenir Next Condensed Demi Bold","Avenir Next Condensed Heavy","Avenir Next Condensed Medium","Avenir Next Condensed Ultra Light","Avenir Roman","Baoli SC","Baoli TC","Baskerville SemiBold","BiauKai","Bodoni 72 Book","Bodoni 72 Oldstyle Book","Bodoni 72 Smallcaps Book","Charcoal CY","Charter Roman","Copperplate Light","Damascus Light","Damascus Medium","Damascus Semi Bold","Futura Condensed ExtraBold","Futura Condensed Medium","Futura Medium","Geneva CY","Gill Sans Light","Gill Sans SemiBold","Gill Sans UltraBold","GungSeo","Hannotate SC","Hannotate TC","HanziPen SC","HanziPen TC","HeadLineA","Hei","Heiti SC Light","Heiti SC Medium","Heiti TC Light","Heiti TC Medium","Helvetica CY Bold","Helvetica Light","Helvetica Neue Condensed Black","Helvetica Neue Condensed Bold","Helvetica Neue Light","Helvetica Neue Medium","Helvetica Neue UltraLight","Herculanum","Hiragino Kaku Gothic Pro W3","Hiragino Kaku Gothic Pro W6","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic ProN W3","Hiragino Kaku Gothic ProN W6","Hiragino Kaku Gothic Std W8","Hiragino Kaku Gothic StdN W8","Hiragino Maru Gothic Pro W4","Hiragino Mincho Pro W3","Hiragino Mincho Pro W6","Hiragino Sans CNS W3","Hiragino Sans CNS W6","Hoefler Text Black","ITF Devanagari Book","ITF Devanagari Demi","ITF Devanagari Light","ITF Devanagari Marathi Book","ITF Devanagari Marathi Demi","ITF Devanagari Marathi Light","ITF Devanagari Marathi Medium","ITF Devanagari Medium","Iowan Old Style Black","Iowan Old Style Bold","Iowan Old Style Italic","Iowan Old Style Roman","Iowan Old Style Titling","Kai","Kaiti SC","Kaiti SC Black","Kaiti TC","Kaiti TC Black","Klee Demibold","Klee Medium","Kohinoor Bangla Light","Kohinoor Bangla Medium","Kohinoor Bangla Semibold","Kohinoor Devanagari Light","Kohinoor Devanagari Medium","Kohinoor Devanagari Semibold","Kohinoor Gujarati Light","Kohinoor Gujarati Medium","Kohinoor Gujarati Semibold","Kohinoor Telugu Light","Kohinoor Telugu Medium","Kohinoor Telugu Semibold","Lantinghei SC Demibold","Lantinghei SC Extralight","Lantinghei SC Heavy","Lantinghei TC Demibold","Lantinghei TC Extralight","Lantinghei TC Heavy","LiHei Pro","LiSong Pro","Libian SC","Libian TC","LingWai SC Medium","LingWai TC Medium","Marion","Muna Black","Myriad Arabic","Myriad Arabic Black","Myriad Arabic Light","Myriad Arabic Semibold","Nanum Brush Script","Nanum Pen Script","NanumGothic","NanumGothic ExtraBold","NanumMyeongjo","NanumMyeongjo ExtraBold","New Peninim MT Bold Inclined","New Peninim MT Inclined","Noto Sans Javanese","Optima ExtraBlack","Osaka","Osaka-Mono","PCMyungjo","Papyrus Condensed","Phosphate Inline","Phosphate Solid","PilGi","PingFang HK Light","PingFang HK Medium","PingFang HK Semibold","PingFang HK Ultralight","PingFang SC Light","PingFang SC Medium","PingFang SC Semibold","PingFang SC Ultralight","PingFang TC Light","PingFang TC Medium","PingFang TC Semibold","PingFang TC Ultralight","STFangsong","STHeiti","STIX Two Math","STIX Two Text","STKaiti","STXihei","Seravek","Seravek ExtraLight","Seravek Light","Seravek Medium","SignPainter-HouseScript Semibold","Skia Black","Skia Condensed","Skia Extended","Skia Light","Snell Roundhand Black","Songti SC Black","Songti SC Light","Songti TC Light","Sukhumvit Set Light","Sukhumvit Set Medium","Sukhumvit Set Semi Bold","Sukhumvit Set Text","Superclarendon","Superclarendon Black","Superclarendon Light","Thonburi Light","Times Roman","Toppan Bunkyu Gothic","Toppan Bunkyu Gothic Demibold","Toppan Bunkyu Gothic Regular","Toppan Bunkyu Midashi Gothic Extrabold","Toppan Bunkyu Midashi Mincho Extrabold","Toppan Bunkyu Mincho","Toppan Bunkyu Mincho Regular","Tsukushi A Round Gothic","Tsukushi A Round Gothic Bold","Tsukushi A Round Gothic Regular","Tsukushi B Round Gothic","Tsukushi B Round Gothic Bold","Tsukushi B Round Gothic Regular","Waseem Light","Wawati SC","Wawati TC","Weibei SC Bold","Weibei TC Bold","Xingkai SC Bold","Xingkai SC Light","Xingkai TC Bold","Xingkai TC Light","YuGothic Bold","YuGothic Medium","YuKyokasho Bold","YuKyokasho Medium","YuKyokasho Yoko Bold","YuKyokasho Yoko Medium","YuMincho +36p Kana Demibold","YuMincho +36p Kana Extrabold","YuMincho +36p Kana Medium","YuMincho Demibold","YuMincho Extrabold","YuMincho Medium","Yuanti SC","Yuanti SC Light","Yuanti TC","Yuanti TC Light","Yuppy SC","Yuppy TC",],
	windows: ["Aharoni Bold","Aldhabi","Andalus","Angsana New","AngsanaUPC","Aparajita","Arabic Typesetting","Arial Nova","Arial Nova Cond","Arial Nova Cond Light","Arial Nova Light","Arial Unicode MS","BIZ UDGothic","BIZ UDMincho","BIZ UDMincho Medium","BIZ UDPGothic","BIZ UDPMincho","BIZ UDPMincho Medium","Batang","BatangChe","Browallia New","BrowalliaUPC","Cordia New","CordiaUPC","DFKai-SB","DaunPenh","David","DengXian","DengXian Light","DilleniaUPC","DilleniaUPC Bold","DokChampa","Dotum","DotumChe","Estrangelo Edessa","EucrosiaUPC","Euphemia","FangSong","FrankRuehl","FreesiaUPC","Gautami","Georgia Pro","Georgia Pro Black","Georgia Pro Cond","Georgia Pro Cond Black","Georgia Pro Cond Light","Georgia Pro Cond Semibold","Georgia Pro Light","Georgia Pro Semibold","Gill Sans Nova","Gill Sans Nova Cond","Gill Sans Nova Cond Lt","Gill Sans Nova Cond Ultra Bold","Gill Sans Nova Cond XBd","Gill Sans Nova Light","Gill Sans Nova Ultra Bold","Gisha","Gulim","GulimChe","Gungsuh","GungsuhChe","Ink Free","IrisUPC","Iskoola Pota","JasmineUPC","KaiTi","Kalinga","Kartika","Khmer UI","KodchiangUPC","Kokila","Lao UI","Latha","Leelawadee","Levenim MT","LilyUPC","MS Mincho","MS PMincho","Mangal","Meiryo","Meiryo UI","Microsoft Uighur","MingLiU","MingLiU_HKSCS","Miriam","Miriam Fixed","MoolBoran","Narkisim","Neue Haas Grotesk Text Pro","Neue Haas Grotesk Text Pro Medium","Nyala","PMingLiU","Plantagenet Cherokee","Raavi","Rockwell Nova","Rockwell Nova Cond","Rockwell Nova Cond Light","Rockwell Nova Extra Bold","Rockwell Nova Light Italic","Rockwell Nova Rockwell","Rod","Sakkal Majalla","Sanskrit Text","Segoe Pseudo","Shonar Bangla","Shruti","SimHei","Simplified Arabic","Simplified Arabic Fixed","Traditional Arabic","Tunga","UD Digi Kyokasho","UD Digi Kyokasho N-B","UD Digi Kyokasho N-R","UD Digi Kyokasho NK-B","UD Digi Kyokasho NK-R","UD Digi Kyokasho NP-B","UD Digi Kyokasho NP-R","Urdu Typesetting","Utsaah","Vani","Verdana Pro","Verdana Pro Black","Verdana Pro Cond","Verdana Pro Cond Black","Verdana Pro Cond Light","Verdana Pro Cond SemiBold","Verdana Pro Light","Verdana Pro SemiBold","Vijaya","Vrinda","Yu Mincho","Yu Mincho Demibold","Yu Mincho Light",],
}
let fntBase = {
	// https://searchfox.org/mozilla-central/search?path=StandardFonts*.inc
	android: [],linux: [],
	mac: ["Al Bayan","Al Nile","Al Tarikh","American Typewriter","Andale Mono","Apple Braille","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Apple Symbols","AppleGothic","AppleMyungjo","Arial","Arial Black","Arial Hebrew","Arial Hebrew Scholar","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Black","Avenir Black Oblique","Avenir Book","Avenir Heavy","Avenir Light","Avenir Medium","Avenir Next","Avenir Next Demi Bold","Avenir Next Heavy","Avenir Next Medium","Avenir Next Ultra Light","Avenir Oblique","Ayuthaya","Baghdad","Bangla MN","Bangla Sangam MN","Baskerville","Beirut","Big Caslon Medium","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni Ornaments","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Charter Black","Cochin","Comic Sans MS","Copperplate","Corsiva Hebrew","Courier","Courier New","DIN Alternate","DIN Condensed","Damascus","DecoType Naskh","Devanagari MT","Devanagari Sangam MN","Didot","Diwan Kufi","Diwan Thuluth","Euphemia UCAS","Farah","Farisi","Futura","GB18030 Bitmap","Galvji","Geeza Pro","Geneva","Georgia","Gill Sans","Gujarati MT","Gujarati Sangam MN","Gurmukhi MN","Gurmukhi MT","Gurmukhi Sangam MN","Heiti SC","Heiti TC","Helvetica","Helvetica Neue","Hiragino Maru Gothic ProN","Hiragino Maru Gothic ProN W4","Hiragino Mincho ProN","Hiragino Mincho ProN W3","Hiragino Mincho ProN W6","Hiragino Sans","Hiragino Sans GB","Hiragino Sans GB W3","Hiragino Sans GB W6","Hiragino Sans W0","Hiragino Sans W1","Hiragino Sans W2","Hiragino Sans W3","Hiragino Sans W4","Hiragino Sans W5","Hiragino Sans W6","Hiragino Sans W7","Hiragino Sans W8","Hiragino Sans W9","Hoefler Text","Hoefler Text Ornaments","ITF Devanagari","ITF Devanagari Marathi","Impact","InaiMathi","Kailasa","Kannada MN","Kannada Sangam MN","Kefa","Khmer MN","Khmer Sangam MN","Kohinoor Bangla","Kohinoor Devanagari","Kohinoor Gujarati","Kohinoor Telugu","Kokonor","Krungthep","KufiStandardGK","Lao MN","Lao Sangam MN","Lucida Grande","Luminari","Malayalam MN","Malayalam Sangam MN","Marker Felt","Menlo","Microsoft Sans Serif","Mishafi","Mishafi Gold","Monaco","Mshtakan","Mukta Mahee","Muna","Myanmar MN","Myanmar Sangam MN","Nadeem","New Peninim MT","Noteworthy","Noto Nastaliq Urdu","Noto Sans Kannada","Noto Sans Myanmar","Noto Sans Oriya","Noto Serif Myanmar","Optima","Oriya MN","Oriya Sangam MN","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Palatino","Papyrus","Phosphate","PingFang HK","PingFang SC","PingFang TC","Plantagenet Cherokee","Raanana","Rockwell","STIXGeneral","STIXIntegralsD","STIXIntegralsSm","STIXIntegralsUp","STIXIntegralsUpD","STIXIntegralsUpSm","STIXNonUnicode","STIXSizeFiveSym","STIXSizeFourSym","STIXSizeOneSym","STIXSizeThreeSym","STIXSizeTwoSym","STIXVariants","STSong","Sana","Sathu","Savoye LET","Shree Devanagari 714","SignPainter","SignPainter-HouseScript","Silom","Sinhala MN","Sinhala Sangam MN","Skia","Snell Roundhand","Songti SC","Songti TC","Sukhumvit Set","Symbol","Tahoma","Tamil MN","Tamil Sangam MN","Telugu MN","Telugu Sangam MN","Thonburi","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Waseem","Webdings","Wingdings","Wingdings 2","Wingdings 3","Zapf Dingbats","Zapfino",],
	windows: ["AlternateGothic2 BT","Arial","Arial Black","Arial Narrow","Bahnschrift","Bahnschrift Light","Bahnschrift SemiBold","Bahnschrift SemiLight","Calibri","Calibri Light","Calibri Light Italic","Cambria","Cambria Math","Candara","Candara Light","Comic Sans MS","Consolas","Constantia","Corbel","Corbel Light","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Javanese Text","Leelawadee UI","Leelawadee UI Semilight","Lucida Console","Lucida Sans Unicode","MS Gothic","MS PGothic","MS UI Gothic","MV Boli","Malgun Gothic","Malgun Gothic Semilight","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei Light","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft YaHei Light","Microsoft YaHei UI","Microsoft YaHei UI Light","Microsoft Yi Baiti","MingLiU-ExtB","MingLiU_HKSCS-ExtB","Mongolian Baiti","Myanmar Text","NSimSun","Nirmala UI","Nirmala UI Semilight","PMingLiU-ExtB","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Black","Segoe UI Emoji","Segoe UI Historic","Segoe UI Light","Segoe UI Semibold","Segoe UI Semilight","Segoe UI Symbol","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Heading","Sitka Small","Sitka Subheading","Sitka Text","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic","Yu Gothic Light","Yu Gothic Medium","Yu Gothic UI","Yu Gothic UI Light","Yu Gothic UI Semibold","Yu Gothic UI Semilight",],
}
let fntFaces = {
	android: [],linux: [],
	mac: ["Al Bayan Bold","Al Bayan Plain","Al Nile Bold","Al Tarikh Regular","American Typewriter Bold","American Typewriter Condensed Bold","Apple SD Gothic Neo Bold","Apple SD Gothic Neo Regular","Apple SD Gothic Neo Thin","AppleGothic Regular","AppleMyungjo Regular","Arial Bold","Arial Bold Italic","Arial Hebrew Bold","Arial Hebrew Light","Arial Hebrew Scholar Bold","Arial Hebrew Scholar Light","Arial Italic","Arial Narrow Bold","Arial Narrow Bold Italic","Arial Narrow Italic","Athelas Bold","Athelas Bold Italic","Athelas Italic","Athelas Regular","Avenir Next Bold","Avenir Next Bold Italic","Avenir Next Condensed Bold Italic","Avenir Next Condensed Demi Bold Italic","Avenir Next Condensed Heavy Italic","Avenir Next Condensed Italic","Avenir Next Condensed Medium Italic","Avenir Next Condensed Regular","Avenir Next Condensed Ultra Light Italic","Avenir Next Demi Bold Italic","Avenir Next Heavy Italic","Avenir Next Italic","Avenir Next Medium Italic","Avenir Next Regular","Avenir Next Ultra Light Italic","Baghdad Regular","Bangla MN Bold","Bangla Sangam MN Bold","Baoli SC Regular","Baoli TC Regular","Baskerville Bold","Baskerville Bold Italic","Baskerville Italic","Baskerville SemiBold Italic","Beirut Regular","Bodoni 72 Bold","Bodoni 72 Book Italic","Bodoni 72 Oldstyle Bold","Bodoni 72 Oldstyle Book Italic","Bradley Hand Bold","Brush Script MT Italic","Chalkboard Bold","Chalkboard SE Bold","Chalkboard SE Light","Chalkboard SE Regular","Charter Black Italic","Charter Bold","Charter Bold Italic","Charter Italic","Cochin Bold","Cochin Bold Italic","Cochin Italic","Comic Sans MS Bold","Copperplate Bold","Corsiva Hebrew Bold","Courier Bold","Courier Bold Oblique","Courier New Bold","Courier New Bold Italic","Courier New Italic","Courier Oblique","DIN Alternate Bold","DIN Condensed Bold","Damascus Bold","Damascus Regular","DecoType Naskh Regular","Devanagari MT Bold","Devanagari Sangam MN Bold","Didot Bold","Didot Italic","Diwan Kufi Regular","Diwan Thuluth Regular","Euphemia UCAS Bold","Euphemia UCAS Italic","Farah Regular","Farisi Regular","Futura Bold","Futura Medium Italic","Galvji Bold","Galvji Bold Oblique","Galvji Oblique","Geeza Pro Bold","Geeza Pro Regular","Georgia Bold","Georgia Bold Italic","Georgia Italic","Gill Sans Bold","Gill Sans Bold Italic","Gill Sans Italic","Gill Sans Light Italic","Gill Sans SemiBold Italic","Gujarati MT Bold","Gujarati Sangam MN Bold","GungSeo Regular","Gurmukhi MN Bold","Gurmukhi Sangam MN Bold","Hannotate SC Bold","Hannotate SC Regular","Hannotate TC Bold","Hannotate TC Regular","HanziPen SC Bold","HanziPen SC Regular","HanziPen TC Bold","HanziPen TC Regular","HeadLineA Regular","Hei Regular","Helvetica Bold","Helvetica Bold Oblique","Helvetica CY BoldOblique","Helvetica CY Oblique","Helvetica CY Plain","Helvetica Light Oblique","Helvetica Neue Bold","Helvetica Neue Bold Italic","Helvetica Neue Italic","Helvetica Neue Light Italic","Helvetica Neue Medium Italic","Helvetica Neue Thin","Helvetica Neue Thin Italic","Helvetica Neue UltraLight Italic","Helvetica Oblique","Hoefler Text Black Italic","Hoefler Text Italic","ITF Devanagari Bold","ITF Devanagari Marathi Bold","InaiMathi Bold","Iowan Old Style Black Italic","Iowan Old Style Bold Italic","Kai Regular","Kailasa Bold","Kailasa Regular","Kaiti SC Bold","Kaiti SC Regular","Kaiti TC Bold","Kaiti TC Regular","Kannada MN Bold","Kannada Sangam MN Bold","Kefa Bold","Kefa Regular","Khmer MN Bold","Kohinoor Bangla Bold","Kohinoor Devanagari Bold","Kohinoor Devanagari Regular","Kohinoor Gujarati Bold","Kohinoor Telugu Bold","Kokonor Regular","KufiStandardGK Regular","Lao MN Bold","Libian SC Regular","Libian TC Regular","Lucida Grande Bold","Malayalam MN Bold","Malayalam Sangam MN Bold","Marion Bold","Marion Italic","Marion Regular","Marker Felt Thin","Marker Felt Wide","Menlo Bold","Menlo Bold Italic","Menlo Italic","Menlo Regular","Mishafi Gold Regular","Mishafi Regular","Mshtakan Bold","Mshtakan BoldOblique","Mshtakan Oblique","Muna Bold","Muna Regular","Myanmar MN Bold","Myanmar Sangam MN Bold","Myriad Arabic Black Italic","Myriad Arabic Bold","Myriad Arabic Bold Italic","Myriad Arabic Italic","Myriad Arabic Light Italic","Myriad Arabic Semibold Italic","Nadeem Regular","NanumGothic Bold","NanumMyeongjo Bold","New Peninim MT Bold","Noteworthy Bold","Noteworthy Light","Noto Nastaliq Urdu Bold","Optima Bold","Optima Bold Italic","Optima Italic","Optima Regular","Oriya MN Bold","Oriya Sangam MN Bold","PCMyungjo Regular","PT Mono Bold","PT Sans Bold","PT Sans Bold Italic","PT Sans Caption Bold","PT Sans Italic","PT Sans Narrow Bold","PT Serif Bold","PT Serif Bold Italic","PT Serif Caption Italic","PT Serif Italic","Palatino Bold","Palatino Bold Italic","Palatino Italic","PilGi Regular","PingFang HK Regular","PingFang HK Thin","PingFang SC Regular","PingFang SC Thin","PingFang TC Regular","PingFang TC Thin","Raanana Bold","Rockwell Bold","Rockwell Bold Italic","Rockwell Italic","STIX Two Text Bold","STIX Two Text Bold Italic","STIX Two Text Italic","STIXGeneral-Bold","STIXGeneral-BoldItalic","STIXGeneral-Italic","STIXGeneral-Regular","STIXIntegralsD-Bold","STIXIntegralsD-Regular","STIXIntegralsSm-Bold","STIXIntegralsSm-Regular","STIXIntegralsUp-Bold","STIXIntegralsUp-Regular","STIXIntegralsUpD-Bold","STIXIntegralsUpD-Regular","STIXIntegralsUpSm-Bold","STIXIntegralsUpSm-Regular","STIXNonUnicode-Bold","STIXNonUnicode-BoldItalic","STIXNonUnicode-Italic","STIXNonUnicode-Regular","STIXSizeFiveSym-Regular","STIXSizeFourSym-Bold","STIXSizeFourSym-Regular","STIXSizeOneSym-Bold","STIXSizeOneSym-Regular","STIXSizeThreeSym-Bold","STIXSizeThreeSym-Regular","STIXSizeTwoSym-Bold","STIXSizeTwoSym-Regular","STIXVariants-Bold","STIXVariants-Regular","Sana Regular","Savoye LET Plain:1.0","Seravek Bold","Seravek Bold Italic","Seravek ExtraLight Italic","Seravek Italic","Seravek Light Italic","Seravek Medium Italic","Shree Devanagari 714 Bold","Shree Devanagari 714 Bold Italic","Shree Devanagari 714 Italic","Sinhala MN Bold","Sinhala Sangam MN Bold","Skia Black Condensed","Skia Black Extended","Skia Bold","Skia Light Condensed","Skia Light Extended","Skia Regular","Snell Roundhand Bold","Songti SC Bold","Songti SC Regular","Songti TC Bold","Songti TC Regular","Sukhumvit Set Bold","Sukhumvit Set Thin","Superclarendon Black Italic","Superclarendon Bold","Superclarendon Bold Italic","Superclarendon Italic","Superclarendon Light Italic","Superclarendon Regular","Tahoma Bold","Tamil MN Bold","Tamil Sangam MN Bold","Telugu MN Bold","Telugu Sangam MN Bold","Thonburi Bold","Times Bold","Times Bold Italic","Times Italic","Times New Roman Bold","Times New Roman Bold Italic","Times New Roman Italic","Trebuchet MS Bold","Trebuchet MS Bold Italic","Trebuchet MS Italic","Verdana Bold","Verdana Bold Italic","Verdana Italic","Waseem Regular","Wawati SC Regular","Wawati TC Regular","Yuanti SC Bold","Yuanti SC Regular","Yuanti TC Bold","Yuanti TC Regular","Yuppy SC Regular","Yuppy TC Regular",],
	windows: ["Angsana New Bold","Angsana New Bold Italic","Angsana New Italic","AngsanaUPC Bold","AngsanaUPC Bold Italic","AngsanaUPC Italic","Aparajita Bold","Aparajita Bold Italic","Aparajita Italic","Arial Bold","Arial Bold Italic","Arial Italic","Arial Narrow Bold","Arial Narrow Bold Italic","Arial Narrow Italic","Arial Nova Bold","Arial Nova Bold Italic","Arial Nova Cond Bold","Arial Nova Cond Bold Italic","Arial Nova Cond Italic","Arial Nova Cond Light Italic","Arial Nova Italic","Arial Nova Light Italic","BIZ UDGothic Bold","BIZ UDPGothic Bold","Browallia New Bold","Browallia New Bold Italic","Browallia New Italic","BrowalliaUPC Bold","BrowalliaUPC Bold Italic","BrowalliaUPC Italic","Calibri Bold","Calibri Bold Italic","Calibri Italic","Cambria Bold","Cambria Bold Italic","Cambria Italic","Candara Bold","Candara Bold Italic","Candara Italic","Candara Light Italic","Comic Sans MS Bold","Comic Sans MS Bold Italic","Comic Sans MS Italic","Consolas Bold","Consolas Bold Italic","Consolas Italic","Constantia Bold","Constantia Bold Italic","Constantia Italic","Corbel Bold","Corbel Bold Italic","Corbel Italic","Corbel Light Italic","Cordia New Bold","Cordia New Bold Italic","Cordia New Italic","CordiaUPC Bold","CordiaUPC Bold Italic","CordiaUPC Italic","Courier New Bold","Courier New Bold Italic","Courier New Italic","David Bold","DengXian Bold","DilleniaUPC Bold Italic","DilleniaUPC Italic","Ebrima Bold","EucrosiaUPC Bold","EucrosiaUPC Bold Italic","EucrosiaUPC Italic","Franklin Gothic Medium Italic","FreesiaUPC Bold","FreesiaUPC Bold Italic","FreesiaUPC Italic","Gadugi Bold","Gautami Bold","Georgia Bold","Georgia Bold Italic","Georgia Italic","Georgia Pro Black Italic","Georgia Pro Bold","Georgia Pro Bold Italic","Georgia Pro Cond Black Italic","Georgia Pro Cond Bold","Georgia Pro Cond Bold Italic","Georgia Pro Cond Italic","Georgia Pro Cond Light Italic","Georgia Pro Cond Semibold Italic","Georgia Pro Italic","Georgia Pro Light Italic","Georgia Pro Semibold Italic","Gill Sans Nova Bold","Gill Sans Nova Bold Italic","Gill Sans Nova Cond Bold","Gill Sans Nova Cond Bold Italic","Gill Sans Nova Cond Italic","Gill Sans Nova Cond Lt Italic","Gill Sans Nova Cond XBd Italic","Gill Sans Nova Italic","Gill Sans Nova Light Italic","Gisha Bold","IrisUPC Bold","IrisUPC Bold Italic","IrisUPC Italic","Iskoola Pota Bold","JasmineUPC Bold","JasmineUPC Bold Italic","JasmineUPC Italic","Kalinga Bold","Kartika Bold","Khmer UI Bold","KodchiangUPC Bold","KodchiangUPC Bold Italic","KodchiangUPC Italic","Kokila Bold","Kokila Bold Italic","Kokila Italic","Lao UI Bold","Latha Bold","Leelawadee Bold","Leelawadee UI Bold","Levenim MT Bold","LilyUPC Bold","LilyUPC Bold Italic","LilyUPC Italic","Malgun Gothic Bold","Mangal Bold","Meiryo Bold","Meiryo Bold Italic","Meiryo Italic","Meiryo UI Bold","Meiryo UI Bold Italic","Meiryo UI Italic","Microsoft JhengHei Bold","Microsoft JhengHei Regular","Microsoft JhengHei UI Bold","Microsoft JhengHei UI Regular","Microsoft New Tai Lue Bold","Microsoft PhagsPa Bold","Microsoft Tai Le Bold","Microsoft Uighur Bold","Microsoft YaHei Bold","Microsoft YaHei UI Bold","Myanmar Text Bold","Neue Haas Grotesk Text Pro Bold","Neue Haas Grotesk Text Pro Bold Italic","Neue Haas Grotesk Text Pro Italic","Neue Haas Grotesk Text Pro Medium Italic","Nirmala UI Bold","Palatino Linotype Bold","Palatino Linotype Bold Italic","Palatino Linotype Italic","Raavi Bold","Rockwell Nova Bold","Rockwell Nova Bold Italic","Rockwell Nova Cond Bold","Rockwell Nova Cond Bold Italic","Rockwell Nova Cond Italic","Rockwell Nova Cond Light Italic","Rockwell Nova Extra Bold Italic","Rockwell Nova Italic","Sakkal Majalla Bold","Segoe Print Bold","Segoe Script Bold","Segoe UI Black Italic","Segoe UI Bold","Segoe UI Bold Italic","Segoe UI Italic","Segoe UI Light Italic","Segoe UI Semibold Italic","Segoe UI Semilight Italic","Shonar Bangla Bold","Shruti Bold","Simplified Arabic Bold","Sitka Banner Bold","Sitka Banner Bold Italic","Sitka Banner Italic","Sitka Display Bold","Sitka Display Bold Italic","Sitka Display Italic","Sitka Heading Bold","Sitka Heading Bold Italic","Sitka Heading Italic","Sitka Small Bold","Sitka Small Bold Italic","Sitka Small Italic","Sitka Subheading Bold","Sitka Subheading Bold Italic","Sitka Subheading Italic","Sitka Text Bold","Sitka Text Bold Italic","Sitka Text Italic","Tahoma Bold","Times New Roman Bold","Times New Roman Bold Italic","Times New Roman Italic","Traditional Arabic Bold","Trebuchet MS Bold","Trebuchet MS Bold Italic","Trebuchet MS Italic","Tunga Bold","Urdu Typesetting Bold","Utsaah Bold","Utsaah Bold Italic","Utsaah Italic","Vani Bold","Verdana Bold","Verdana Bold Italic","Verdana Italic","Verdana Pro Black Italic","Verdana Pro Bold","Verdana Pro Bold Italic","Verdana Pro Cond Black Italic","Verdana Pro Cond Bold","Verdana Pro Cond Bold Italic","Verdana Pro Cond Italic","Verdana Pro Cond Light Italic","Verdana Pro Cond SemiBold Italic","Verdana Pro Italic","Verdana Pro Light Italic","Verdana Pro SemiBold Italic","Vijaya Bold","Vrinda Bold","Yu Gothic Bold","Yu Gothic Regular","Yu Gothic UI Bold","Yu Gothic UI Regular","Yu Mincho Regular",],
}
let fntAlways = {
	android: [],linux: [],mac: [],
	windows: ["Courier","Helvetica","MS Sans Serif","MS Serif","Roman","Small Fonts","Times","宋体","微软雅黑","新細明體","細明體","굴림","굴림체","바탕","ＭＳ ゴシック","ＭＳ 明朝","ＭＳ Ｐゴシック","ＭＳ Ｐ明朝",],
}
let fntTBOther = {android: [], linux: [],mac: [], windows: []}
let fntTB = {
	android: [],linux: [],
	mac: ["AppleGothic","Apple Color Emoji","Arial","Arial Black","Arial Narrow","Courier","Geneva","Georgia","Heiti TC","Helvetica","Helvetica Neue", ".Helvetica Neue DeskInterface","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic ProN W3","Hiragino Kaku Gothic ProN W6","Lucida Grande","Menlo","Monaco","STHeiti","Tahoma","Thonburi","Times","Times New Roman","Verdana",],
	windows: ["Arial","Arial Black","Arial Narrow","Batang","Cambria Math","Consolas","Courier New","Euphemia","Gautami","Georgia","Gulim","GulimChe","Iskoola Pota","Kalinga","Kartika","Latha","Lucida Console","MS Gothic","MV Boli","Malgun Gothic","Malgun Gothic Semilight","Mangal","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft YaHei","Microsoft YaHei Light","Microsoft YaHei UI","Microsoft YaHei UI Light","MingLiU","Nyala","PMingLiU","Plantagenet Cherokee","Raavi","Segoe UI","Segoe UI Black","Segoe UI Light", "Segoe UI Semibold","Segoe UI Semilight","Shruti","SimSun","Sylfaen","Tahoma","Times New Roman","Tunga","Verdana","Vrinda","Yu Gothic UI","Yu Gothic UI Light","Yu Gothic UI Semibold","Yu Gothic UI Semilight","MS Mincho","MS PGothic","MS PMincho",],
}
let fntTBBundled = {
	// https://gitlab.torproject.org/tpo/applications/tor-browser-build/-/issues/40529
	android: [],
	linux: [
		"Arimo","Cousine","STIX Math","Tinos","Twemoji Mozilla",
		"Noto Naskh Arabic",
		"Noto Sans Armenian","Noto Sans Balinese","Noto Sans Bengali","Noto Sans Buginese","Noto Sans Canadian Aboriginal","Noto Sans Cherokee","Noto Sans Devanagari","Noto Sans Ethiopic","Noto Sans Georgian","Noto Sans Gujarati","Noto Sans Gurmukhi","Noto Sans Hebrew","Noto Sans Kannada","Noto Sans Khmer","Noto Sans Lao","Noto Sans Malayalam","Noto Sans Mongolian","Noto Sans Myanmar","Noto Sans Oriya","Noto Sans Sinhala","Noto Sans Tamil","Noto Sans Telugu","Noto Sans Thaana","Noto Sans Thai","Noto Sans Yi",
		"Noto Serif Armenian","Noto Serif Balinese","Noto Serif Bengali","Noto Serif Devanagari","Noto Serif Ethiopic","Noto Serif Georgian","Noto Serif Gujarati","Noto Serif Gurmukhi","Noto Serif Hebrew","Noto Serif Kannada","Noto Serif Khmer","Noto Serif Lao","Noto Serif Malayalam","Noto Serif Myanmar","Noto Serif Sinhala","Noto Serif Tamil","Noto Serif Telugu","Noto Serif Thai","Noto Serif Tibetan",
		// linux only: CJK
		"Noto Sans JP Regular","Noto Sans KR Regular","Noto Sans SC Regular", "Noto Sans TC Regular",
		// legacy
		"Noto Emoji", // twemoji
		"Noto Sans Tibetan", // serif
	],
	mac: [
		"Noto Sans Armenian","Noto Sans Bengali","Noto Sans Buginese","Noto Sans Canadian Aboriginal","Noto Sans Cherokee","Noto Sans Devanagari","Noto Sans Ethiopic","Noto Sans Gujarati","Noto Sans Gurmukhi","Noto Sans Kannada","Noto Sans Khmer","Noto Sans Lao","Noto Sans Malayalam","Noto Sans Mongolian","Noto Sans Myanmar","Noto Sans Oriya","Noto Sans Sinhala","Noto Sans Tamil","Noto Sans Telugu","Noto Sans Thaana","Noto Sans Yi",
		"Noto Serif Tibetan",
		"STIX Math","Twemoji Mozilla",
		// legacy
		"Noto Sans Tibetan", // serif
	],
	windows: [
		"Noto Sans","Noto Sans Balinese","Noto Sans Bengali","Noto Sans Buginese","Noto Sans Canadian Aboriginal","Noto Sans Cherokee","Noto Sans Devanagari","Noto Sans Ethiopic","Noto Sans Georgian","Noto Sans Gujarati","Noto Sans Gurmukhi","Noto Sans Kannada","Noto Sans Khmer","Noto Sans Lao","Noto Sans Malayalam","Noto Sans Myanmar","Noto Sans Oriya","Noto Sans Sinhala","Noto Sans Tamil","Noto Sans Telugu","Noto Sans Yi",
		"Noto Serif","Noto Serif Balinese","Noto Serif Bengali","Noto Serif Devanagari","Noto Serif Ethiopic","Noto Serif Georgian","Noto Serif Gujarati","Noto Serif Gurmukhi","Noto Serif Kannada","Noto Serif Khmer","Noto Serif Lao","Noto Serif Malayalam","Noto Serif Myanmar","Noto Serif Sinhala","Noto Serif Tamil","Noto Serif Telugu","Noto Serif Tibetan",
		"Twemoji Mozilla",
	],
}

function log_list(name) {
	let listArray = []
	if (name == "base") {
		listArray = fntBase[strOS]
	} else if (name == "whitelist") {
		listArray = fntTB[strOS]
	} else if (name == "faces") {
		listArray = fntFaces[strOS]
	} else if (name == "max") {
		listArray = fntMaster[strOS]
	} else if (name == "other") {
		listArray = fntOther[strOS]
	} else if (name == "TB other") {
		listArray = fntTBOther[strOS]
	} else if (name == "always") {
		listArray = fntAlways[strOS]
	} else if (name == "bundled") {
		listArray = fntTBBundled[strOS]
	} else if (name == "min") {
		listArray = fntMasterBase[strOS]
	} else if (name == "medium") {
		if (bTB) {
			listArray = fntMasterBase[strOS].concat(fntTBOther[strOS])
		} else {
			listArray = fntMasterBase[strOS].concat(fntOther[strOS])
		}
	} else if (baseGeneric.includes(name)) {
			listArray = oBaseFonts[name]
	}
	listArray.sort()
	let logtype = dom.logtype.checked
	if (listArray.length) {
		if (logtype) {
			// list format
			console.log(name.toUpperCase() +", "+ listArray.length +"\n\""+ listArray.join("\",\"") + "\",")
		} else {
			// line format
			console.log(name.toUpperCase(), listArray.length)
			console.log("\""+ listArray.join("\",\n\"") +"\",")
		}
	}
}

function button(name, len) {
	let isRed = len == 0 ? true : false
	if (name !== "bundled") {len = (len+"").padStart(3)}
	if (isRed) {len = sb + len + sc}
	return "<span class='btnb' onClick='log_list(`"+ name +"`)'>" + s12 + len + sc +"</span>"
}

function check_fntLists() {
	// we'll expand on the data checks in set_fntListMaster + output a pretty status report
		// duplicates + sorting in each list
		// expected master hash changes
		// sorting required etc
	console.log(fntDupes)
}

function set_fntListMaster() {
	// note: we only call this function once
	// create: fntMaster & fntMasterBase
	fntFake = ".00"+ rnd_string() + " poison pill"
	let names = Object.keys(fntMaster)
	for (const k of names) {
		// always add a poison pill
		fntAlways[k].push(fntFake)
		// tb other
		let tbMin = fntTB[k].concat(fntAlways[k])
		tbMin = tbMin.concat(fntTBBundled[k])
		let tbAll = tbMin.concat(fntBase[k])
		tbAll = tbAll.concat(fntOther[k])
		tbAll = tbAll.filter(function(item, position) {return tbAll.indexOf(item) === position})
		tbAll = tbAll.sort()
		let tbOther = tbAll.filter(x => !tbMin.includes(x)) // e.g. win: 81 min, 254 everything-else so 173 other
		fntTBOther[k] = tbOther
		// master
		let array = fntAlways[k]
		if (bTB) {
			array = array.concat(fntTBBundled[k])
			array = array.concat(fntTB[k])
			array = array.concat(fntTBOther[k])
		} else {
			array = array.concat(fntBase[k])
			array = array.concat(fntOther[k])
		}
		array = array.concat(fntFaces[k])
		array.sort()
		// spot duplicates
		let next = "", dupes = []
		for (let i = 0; i < array.length; i++) {
			let current = array[i]
			if (i !== array.length) {
				if (current == array[i+1]) {dupes.push(current)} 
			}
		}
		if (dupes.length) {
			fntDupes[k] = dupes
			console.log("duplicated font(s):", dupes.join(", "))
		}
		// dedupe & carry on
		array = array.filter(function(item, position) {return array.indexOf(item) === position})
		fntMaster[k] = array
		// masterbase
		if (bTB) {
			array = tbMin
		} else {
			array = fntBase[k].concat(fntAlways[k])
		}
		array.sort()
		array = array.filter(function(item, position) {return array.indexOf(item) === position})
		fntMasterBase[k] = array
	}
	//console.debug(fntMaster)
	//console.debug(fntMasterBase)

	// set test lists to match OS
	fntList = fntMaster[strOS]
	fntList.sort()

	// stats
	let btnO = button((bTB ? "TB other" : "other"), (bTB ? fntTBOther[strOS].length : fntOther[strOS].length)),
		btnS = button("faces", fntFaces[strOS].length),
		btnB = button((bTB ? "whitelist" : "base"), (bTB ? fntTB[strOS].length : fntBase[strOS].length)),
		btnBun = button("bundled", fntTBBundled[strOS].length),
		btnA = button("always", fntAlways[strOS].length)

	let	btnMin = button("min", fntMasterBase[strOS].length),
		btnMed = button("medium", fntMasterBase[strOS].length + (bTB ? fntTBOther[strOS].length: fntOther[strOS].length)),
		btnMax = button("max", fntMaster[strOS].length)

	let display = []
	let lines = []
	display.push(s12 +"   MIN:"+ sc +"always ".padStart(10) + btnA)
	let strBase = bTB ? "whitelist " : "base "
	display.push(strBase.padStart(10) + btnB)
	display.push("min ".padStart(10) + btnMin + (bTB ? " [includes "+ btnBun +" bundled]": ""))
	lines.push(display.join(" | "))
	
	display = []
	display.push(s12 +"MEDIUM:"+ sc +"min ".padStart(10) + btnMin)
	let strOther = bTB ? "TB other " : "other "
	display.push(strOther.padStart(10) + btnO)
	display.push("medium ".padStart(10) + btnMed)
	lines.push(display.join(" | "))

	display = []
	display.push(s12 +"   MAX:"+ sc +"medium ".padStart(10) + btnMed)
	display.push("faces ".padStart(10) + btnS)
	display.push("max ".padStart(10) + btnMax)
	lines.push(display.join(" | "))
	dom.statstitle.innerHTML = "<br>"+ s12 +"FONT LISTS: "+ sc + strOS + (bTB ? sg +" TB"+ sc : "")
	dom.stats.innerHTML = "<br><br>"+ lines.join("<br>")
}

function get_fonts(runtype) {
	getFonts().then(res => {
		// remove element
		try {document.getElementById("font-fingerprint").remove()} catch(e) {}
		// get values
		if (typeof res === "object" && res !== null) {
			for (let name in res) {
				let data = res[name]
				let display = []
				get_isRFP()

				//data.push("Aldhabi","Andalus","Angsana New") // windows base test
				//data.push("Angsana New Bold") // windows full test
				//data.sort()
				//if (runtype == "full" && !bTB) {
				//	data.push("Franklin Gothic Medium") // test basefont not found in min, but found in all = bug
				//	data.sort() // actually this font is a real bug, no need to simulate: all windows
				//}

				if (data.length == 0) {
					dom.results = "nothing found"
					return
				} else {
					display.push(s12 +"base".padStart(12) + sc +": " + fntBaseDimensions)
					display.push(s12 +"stats".padStart(12) + sc +": " + fntBaseStats)
					display.push(s12 +"poison".padStart(12) + sc +": " + fntPoison)

					// calculate default fonts per basefont
					if (!data.includes(fntFake)) {
						// what is in each basefont but not in found
						baseGeneric.forEach(function(basefont) {
							let unique = data.filter(x => !oBaseFonts[basefont].includes(x))
							display.push(s12 + basefont.padStart(12) +sc +": " + (unique.length ? unique.join(", ") : "n/a")
							)
						})
					}

					// all
					let hash = sha1(data.join())
					display.push("<br>"+ s12+ "max".padStart(12) + sc +": " + hash + s12 +" ["+ data.length +"/"+ fntList.length +"]"+ sc)
					// found in all but not in checklist
					let missingInCheck = data.filter(x => !fntListCheck.includes(x))
					// found in both
					let checkData = data.filter(x => !missingInCheck.includes(x))
					let checkHash = sha1(checkData.join())
					/*
					console.debug(fntListCheck)
					console.debug(missingInCheck)
					console.debug(checkData)
					*/

					// BASE: we want to match all
					if (runtype == "min") {
						// android
						if (strOS == "android") {
							if (bTB) {
								display.push("<br>test skipped: Tor Browser for android doesn't have a font whitelist")
							} else {
								display.push("<br>test skipped: RFP font protection doesn't cover android")
							}
						// non-TB & RFP is off
						} else if (!isRFP && !bTB) {
								display.push("<br>test skipped: the min font test requires RFP, flip it on and run again")
						// base fonts > 0
						} else if ((bTB ? fntTB[strOS].length : fntBase[strOS].length) > 0) {
							notFoundInMin = fntListCheck.filter(x => !data.includes(x)) // base list items not found
							// display
							display.push(s12 +"min".padStart(12) + sc +": " + checkHash + s12
							+" ["+ checkData.length +"/"+ fntListCheck.length +"]"+ sc
								+" "+ (hash == checkHash ? green_tick : red_cross) +"<br>"
							)
							// check kBaseFonts integrity
							if (notFoundInMin.length) {
								let fntSuspect = notFoundInMin.filter(x => foundInAll.includes(x))
								fntSuspect = fntSuspect.filter(x => !fntAlways[strOS].includes(x)) // not in kBaseFonts
								if (fntSuspect.length) {
									display.push(s4 + (bTB ? "TB" : "BASE")
										+" FONTS NOT FOUND HERE THAT WERE FOUND IN THE FULL TEST ["+ fntSuspect.length +"]"+ sc +"<br>"
									)
									display.push(fntSuspect.join(", ") + "<br>")
								}
							}
							if (missingInCheck.length) {
								if (missingInCheck.length == fntMaster[strOS].length - fntMasterBase[strOS].length) {
									display.push("<p><details><summary>"+ s12 + "FOUND FONTS NOT IN MIN: ["
										+ missingInCheck.length +"] "+ sc + sb +"[all detected]"+ sc +"</summary><p>")
									display.push(missingInCheck.join(", ") + "<br></p></details>")
								} else {
									display.push(sb + "FOUND FONTS NOT IN MIN: ["+ missingInCheck.length +"]"+ sc +"<br>")
									display.push(missingInCheck.join(", ") + "<br>")
								}
							}
							if (notFoundInMin.length) {
								display.push(s12 + "MIN FONTS NOT FOUND: ["+ notFoundInMin.length +"]"+ sc +"<br>")
								let minString = notFoundInMin.join(", ")
								minString = minString.replace(fntFake, sg + fntFake + sc)
								display.push(minString)
							}
						// test not configured
						} else {
							display.push("<br>the "+ (bTB ? "TB " : "firefox ") + strOS
								+" min test is not configured yet"
							)
						}
					}

					// FULL: we want zero faces found
					if (runtype == "full") {
						// android
						if (strOS == "android") {
							display.push("<br>test skipped: there is no android faces test, never will be")
						// TB
						//} else if (bTB) {
						//		display.push("<br>test skipped: Tor Browser's whitelist blocks a full test")
						// RFP is on
						} else if (isRFP) {
								display.push("<br>test skipped: RFP blocks a full test, flip it off and run again")
						// faces > 0
						} else if (fntFaces[strOS].length > 0) {
							foundInAll = data
							display.push(s12 +"faces".padStart(12) + sc +": " + checkHash + s12
							+" ["+ checkData.length +"/"+ fntListCheck.length +"]"+ sc
								+" "+ (checkData.length ? red_cross : green_tick) +"<br>"
							)
							if (bTB) {
								display.push("note: Tor Browser's whitelist blocks a full test")
							}
							// check kBaseFonts integrity
							if (notFoundInMin.length) {
								let fntSuspect = notFoundInMin.filter(x => foundInAll.includes(x))
								fntSuspect = fntSuspect.filter(x => !fntAlways[strOS].includes(x)) // not in kBaseFonts
								if (fntSuspect.length) {
									display.push(s4 + (bTB ? "TB" : "BASE")
										+" FONTS FOUND HERE THAT WEREN'T FOUND IN THE MIN TEST ["+ fntSuspect.length +"]"+ sc +"<br>")
									display.push(fntSuspect.join(", ") + "<br>")
								}
							}
							if (checkData.length) {
								if (checkData.length == fntFaces[strOS].length) {
									display.push("<p><details><summary>"+ s12 + "FOUND FONTS IN FACES: ["
										+ checkData.length +"] "+ sc + sb +"[all detected]"+ sc +"</summary><p>")
									display.push(checkData.join(", ") + "<br></p></details>")
								} else {
									display.push(s12 +"FOUND FONTS IN FACES: ["+ checkData.length +"]"+ sc +"<br>")
									display.push(checkData.join(", ") + "<br>")
								}
							}
						} else {
							//test not configured
							display.push("<br>the "+ (bTB ? "TB " : "firefox ") + strOS
								+" faces test is not configured yet"
							)
						}
					}
					// missing bundled fonts
					if (bTB) {
						let missingBundled = fntTBBundled[strOS].filter(x => !data.includes(x))
						if (missingBundled.length) {
							display.push("<br>"+ sb + "BUNDLED FONTS"+ sc + " <sup>[CURRENT RELEASE]</sup> "+ sb
								+"NOT FOUND: ["+ missingBundled.length +"]"+ sc +"<br>")
							display.push(missingBundled.join(", "))
						}
					}
					// output
					let dataString = data.join(", ")
					dataString = dataString.replace(fntFake, sb + fntFake + sc)
					let poisonString = data.includes(fntFake) ? sb + " [poison pill]"+ sc : ""
					// check ALL and fntFont
					let allStr = (data.length == fntList.length ? sb +" [all detected]"+ sc: "")

					hash = mini(data)
					dom.results.innerHTML = display.join("<br>")
						+"<p><details><summary>"+ s12 +"ALL FOUND FONTS ["+ data.length +"] "+ sc + hash + allStr + poisonString + "</summary><p>"
						+ dataString + "<br><br></p></details>"
				}
			}
		} else {
			dom.results = "aw snap! something went wrong"
		}
	})
}

const get_OS = () => new Promise(resolve => {
	let el = dom.widget0
	try {
		let font = getComputedStyle(el).getPropertyValue("font-family")
		if (font.slice(0,12) == "MS Shell Dlg") {strOS="windows"
		} else if (font == "Roboto") {strOS="android"
		}	else if (font == "-apple-system") {strOS="mac"
		}	else {strOS="linux"}
		return resolve(strOS)
	} catch(e) {
		strOS = "unknown"
		return resolve("unknown")
	}
})

const get_TB = () => new Promise(resolve => {
	try {
		// extensions can block resources://
			// FF ~5ms, TB ~20ms
		setTimeout(() => resolve(false), 100)
		let css = document.createElement("link")
		css.href = "resource://torbutton-assets/aboutTor.css"
		css.type = "text/css"
		css.rel = "stylesheet"
		document.head.appendChild(css)
		css.onload = function() {
			return resolve(true)
		}
		css.onerror = function() {
			return resolve(false)
		}
		document.head.removeChild(css)
	} catch(e) {
		return resolve(false)
	}
})

function run(runtype) {
	// check
	if (!isFF) {return}
	if (strOS == "unknown") {return}
	setBtn(runtype)

	if (runtype == "min") {
		dom.results = ""
		if (!bTB && strOS !== "android") {
			// FF80+
			try {
				let obj = {[Symbol.toPrimitive]: () => Symbol()}
				let proxy = (new Proxy({},{get: (obj, prop, proxy) => prop}))
				for (let i = 0; i < 11; i++) {if (typeof proxy[obj] == 'symbol') {}}
			} catch (e) {
				dom.results = "test skipped: the min font test requires firefox 80 or higher"
				return
			}
		}
		fntListCheck = fntMasterBase[strOS]
		fntListCheck.sort()
		setTimeout(function() {
			get_fonts("min")
		}, 170)
	}

	if (runtype == "full") {
		dom.results = ""
		// set fonts
		fntListCheck = fntFaces[strOS]
		fntListCheck.sort()
		setTimeout(function() {
			get_fonts("full")
		}, 170)
	}
}

function run_once() {
	let interstitial = "<br>"+ s12 +"FONT LISTS: "+ sc + zNA
	// isFF
	if (!isFF) {
		dom.statstitle.innerHTML = interstitial
		dom.results = "these tests require firefox"
		return
	}
	// set strOS, bTB
	Promise.all([
		get_OS(),
		get_TB(),
	]).then(function(results){
		strOS = results[0]
		// test
		//strOS = "mac"
		//strOS = "linux"
		//strOS = "android"
		bTB = results[1]
		if (strOS == "unknown") {
			dom.statstitle.innerHTML = interstitial
			dom.results = "unknown os"
			return
		} else {
			// create master fontlist
			set_fntListMaster()

			// set baseFonts
				// force alternative fonts in case generic is broken
				// see https://hg.mozilla.org/mozilla-central/rev/931336f048ab#l1.12
				// you can simulate using the fallback by changing font.name-list.[basefont].x-western to a made-up font
				// can't seem to simulate the TB mac issue where everything is found - on windows with no fallback the
				// default fonts simply drop off the found fonts list - with fallback they are found
			if (strOS == "mac") {
				baseFonts = ['monospace, Menlo, Courier, \"Courier New\", Monaco',
					'sans-serif',
					'serif'
				]
			} else if (strOS == "windows") {
				baseFonts = ['monospace, Consolas, Courier, \"Courier New\", \"Lucida Console\"',
					'sans-serif, Arial',
					'serif, \"Times New Roman\", Times, Roman'
				]
			}
		}
	})
}

function setBtn(method) {
	// reset btns
	let items = document.getElementsByClassName("btn8")
	for (let i=0; i < items.length; i++) {
		items[i].classList.add("btn12")
		items[i].classList.remove("btn8")
	}
	// set btn
	let el = document.getElementById("b"+ method)
	el.classList.add("btn8")
	el.classList.remove("btn12")
}

run_once()

const getFonts = () => {
	/* https://github.com/abrahamjuliot/creepjs */
	return new Promise(resolve => {
		if (fntList.length == 0) {
			dom.results = "yikes, the font list is empty"
			return
		}
		try {
			// reset
			fntBaseStats = ""
			fntBaseDimensions = ""
			fntPoison = ""
			oBaseFonts = {}

			const doc = document // or iframe.contentWindow.document
			const id = `font-fingerprint`
			const div = doc.createElement('div')
			div.setAttribute('id', id)
			doc.body.appendChild(div)
			doc.getElementById(id).innerHTML = `
				<style>
				#${id}-detector {
					--font: '';
					position: absolute !important;
					left: -9999px!important;
					font-size: 256px !important;
					font-style: normal !important;
					font-weight: normal !important;
					letter-spacing: normal !important;
					line-break: auto !important;
					line-height: normal !important;
					text-transform: none !important;
					text-align: left !important;
					text-decoration: none !important;
					text-shadow: none !important;
					white-space: normal !important;
					word-break: normal !important;
					word-spacing: normal !important;
					/* in order to test scrollWidth, clientWidth, etc. */
					padding: 0 !important;
					margin: 0 !important;
					/* in order to test inlineSize and blockSize */
					writing-mode: horizontal-tb !important;
					/* for transform and perspective */
					transform-origin: unset !important;
					perspective-origin: unset !important;
				}
				#${id}-detector::after {
					font-family: var(--font);
					content: '` + fntStrA + `';
				}
				</style>
				<span id="${id}-detector"></span>`

			const span = doc.getElementById(`${id}-detector`)
			const detectedViaOffset = new Set()
			const style = getComputedStyle(span)

			const getDimensions = (span, style) => {
				const dimensions = {
					offsetWidth: span.offsetWidth,
					offsetHeight: span.offsetHeight
				}
				return dimensions
			}
			const base = baseFonts.reduce((acc, font) => {
				span.style.setProperty('--font', font)
				const dimensions = getDimensions(span, style)
				acc[font.split(",")[0]] = dimensions
				return acc
			}, {})

			// stats
			let baseFontTests = {}, baseFontDetected = {}, basefontFirst = baseFonts[0]
			baseGeneric.forEach(function(name) {
				baseFontTests[name] = 0
				baseFontDetected[name] = 0
				oBaseFonts[name] = []
			})

			// poison + generic
			let aPoison = []
			baseGeneric.forEach(function(basefont) {
				const family = "'"+ fntFake +"', "+ basefont
				span.style.setProperty('--font', family)
				const style = getComputedStyle(span)
				const dimensions = getDimensions(span, style)
				if (dimensions.offsetWidth != base[basefont].offsetWidth ||
					dimensions.offsetHeight != base[basefont].offsetHeight) {
					aPoison.push(basefont +": "+ sb + "fail" + sc)
				} else {
					aPoison.push(basefont +": "+ sg + "pass" + sc)
				}
			})
			if (aPoison.length) {
				fntPoison = aPoison.join(" | ")
			}

			fntList.forEach(font => {
				baseFonts.forEach(basefont => {
					const family = "'"+ font +"', "+ basefont
					span.style.setProperty('--font', family)
					const style = getComputedStyle(span)
					const dimensions = getDimensions(span, style)
					basefont = basefont.split(",")[0]
					if (dimensions.offsetWidth != base[basefont].offsetWidth ||
						dimensions.offsetHeight != base[basefont].offsetHeight) {
						detectedViaOffset.add(font)
						baseFontDetected[basefont]++
						oBaseFonts[basefont].push(font)
					}
				})
			})

			// BASEFONT STATS
			// tidy count stats
			let aTemp = []
			for (let i = 0; i < baseGeneric.length; i++) {
				let name = baseGeneric[i]
				aTemp.push(name + ": "+ button(name, baseFontDetected[name].toString().padStart(4))) 
			}
			if (aTemp.length) {fntBaseStats = aTemp.join(" | ")}

			// BASEFONT DIMENSIONS
			aTemp = []
			try {
				for (const k of Object.keys(base)) {
					aTemp.push(k + ": "+ s12 + base[k]["offsetWidth"] +" x "+ base[k]["offsetHeight"] + sc)
				}
			} catch(e) {
				aTemp.push(e.name +": "+ e.message)
			}
			if (aTemp.length) {fntBaseDimensions = aTemp.join(" | ")}

			const fontsOffset = [...detectedViaOffset]
			return resolve({
				fontsOffset
			})
		} catch(e) {
			//console.error(e.name, e.message)
			return resolve("error")
		}
	})
}

</script>
</body>
</html>
